{"version":3,"sources":["components/SanitizedHtml.tsx","lib/jmap.ts","features/login/loginSlice.ts","features/mail/content/Mail.tsx","features/mail/content/Empty.tsx","lib/random.ts","features/mail/types.ts","features/mail/mailSlice.ts","features/mail/utils.ts","features/mail/list/Empty.tsx","features/mail/list/List.tsx","features/mail/mailboxes/Empty.tsx","features/mail/mailboxes/List.tsx","features/mail/Layout.tsx","features/login/Layout.tsx","components/ConditionalDisplay.tsx","features/login/utils.ts","App.tsx","features/counter/counterSlice.ts","app/store.ts","serviceWorker.ts","index.tsx"],"names":["SanitizedHtml","html","props","container","useRef","useState","shadowRoot","setShadowRoot","useEffect","current","attachShadow","mode","dom","DOMPurify","sanitize","RETURN_DOM","querySelectorAll","forEach","link","target","rel","innerHTML","appendChild","ref","discoverJmapEndpoint","domain","a","wellKnownURL","fetch","response","url","fetchMailboxes","endpoint","accountId","headers","Headers","method","body","JSON","stringify","using","methodCalls","ids","json","methodResponses","success","message","Array","isArray","length","mbx","list","data","fetchMails","position","limit","calculateTotal","resultOf","name","path","properties","m","fetchMail","emailId","mail","tryCredentials","getBasicToken","username","password","Base64","encode","loginSlice","createSlice","initialState","authenticated","authorizationHeader","identifier","downloadUrl","reducers","login","state","action","payload","logout","actions","isAuthenticated","getLoginPayload","replaceDownloadUrl","blobId","type","URL","replace","encodeURI","href","fetchMailContent","args","mailId","Authorization","mailRequest","mailData","htmlBody","blobUrl","charset","then","r","text","t","content","Mail","loginDetails","useSelector","useQuery","isLoading","error","className","Empty","randomString","chars","charsLength","str","i","charAt","Math","floor","random","newMailbox","role","id","unreadEmails","mailboxes","mailSlice","setMailboxes","setList","selectMailboxes","selectMails","FEATURE_URL","getRouteParams","matchMailbox","useRouteMatch","matchMail","mailboxId","params","getMailboxName","mailbox","getMailboxIcon","getFromMail","from","map","f","email","join","List","routeParams","mailListAll","inboxMailbox","filter","currentMailboxes","currentMailbox","mailList","mailboxIds","Object","prototype","hasOwnProperty","call","backgroundClass","to","keywords","$seen","isUnreadMail","subject","preview","Layout","LoginStep","mailboxesClass","listClass","contentClass","ConditionalDisplay","cond","children","dispatch","useDispatch","Identifier","step","setStep","setError","more","setMore","loading","setLoading","setIdentifier","setPassword","setEndpoint","hasCustomEndpoint","setHasCustomEndpoint","discoverEndpoint","includes","Endpoint","trim","split","pop","discoveredEndpoint","Credentials","actionButton","userInfos","mailboxesRequest","mailsRequest","batch","htmlFor","autoFocus","placeholder","value","onChange","e","onClick","disabled","checked","App","MailUrl","render","LoginUrl","exact","counterSlice","increment","decrement","incrementByAmount","store","configureStore","reducer","counter","counterReducer","mailReducer","loginReducer","Boolean","window","location","hostname","match","queryClient","QueryClient","ReactDOM","StrictMode","QueryClientProvider","client","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","console"],"mappings":"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","file":"static/js/main.4a01ee24.chunk.js","sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport DOMPurify from 'dompurify';\n\nexport interface SanitizedHtmlProps\n  extends React.HTMLAttributes<HTMLDivElement> {\n  html: string;\n}\n\nconst SanitizedHtml: React.FC<SanitizedHtmlProps> = ({ html, ...props }) => {\n  const container = useRef<HTMLDivElement>(null);\n  const [shadowRoot, setShadowRoot] = useState<ShadowRoot | null>(null);\n  useEffect(() => {\n    if (!container.current || shadowRoot) {\n      return;\n    }\n\n    setShadowRoot(container.current.attachShadow({ mode: 'open' }));\n  }, [container, shadowRoot]);\n\n  useEffect(() => {\n    if (!shadowRoot) {\n      return;\n    }\n    const dom = DOMPurify.sanitize(html, { RETURN_DOM: true });\n    dom\n      .querySelectorAll('a')\n      .forEach((link: { target: string; rel: string }) => {\n        link.target = '_blank';\n        link.rel = 'noopener noreferrer';\n      });\n    shadowRoot.innerHTML = '';\n    shadowRoot.appendChild(dom);\n  }, [shadowRoot, html]);\n\n  return <div {...props} ref={container}></div>;\n};\n\nexport default SanitizedHtml;\n","import { Base64 } from 'js-base64';\nimport { Mail, Mailbox } from '../features/mail/types';\n\nexport const discoverJmapEndpoint = async (domain: string): Promise<string> => {\n  const wellKnownURL = `https://${domain}/.well-known/jmap`;\n  const response = await fetch(wellKnownURL);\n  return response.url;\n};\n\ntype JMAPResponse<T> =\n  | {\n      success: false;\n      message: string;\n    }\n  | {\n      success: true;\n      data: T;\n    };\n\nexport const fetchMailboxes = async (\n  endpoint: string,\n  accountId: string,\n  headers?: Record<string, string>,\n): Promise<JMAPResponse<Mailbox[]>> => {\n  const response = await fetch(endpoint, {\n    headers: new Headers({ ...headers, 'Content-Type': 'application/json' }),\n    method: 'POST',\n    body: JSON.stringify({\n      using: ['urn:ietf:params:jmap:core', 'urn:ietf:params:jmap:mail'],\n      methodCalls: [\n        [\n          'Mailbox/get',\n          {\n            accountId: accountId,\n            ids: null,\n          },\n          '0',\n        ],\n      ],\n    }),\n  });\n  const json = await response.json();\n  if (!json.methodResponses) {\n    return {\n      success: false,\n      message: 'not a valid JMAP response',\n    };\n  }\n\n  const methodResponses = json.methodResponses;\n  if (\n    !methodResponses ||\n    !Array.isArray(methodResponses) ||\n    methodResponses.length !== 1\n  ) {\n    return {\n      success: false,\n      message: 'no valid response',\n    };\n  }\n\n  const mbx = methodResponses[0];\n\n  if (mbx[0] !== 'Mailbox/get') {\n    return {\n      success: false,\n      message: 'not the expected method',\n    };\n  }\n  if (!mbx[1] || !mbx[1].list || !Array.isArray(mbx[1].list)) {\n    return {\n      success: false,\n      message: 'could not fetch mailboxes',\n    };\n  }\n\n  const list = mbx[1].list as Mailbox[];\n\n  return {\n    success: true,\n    data: list,\n  };\n};\n\nexport const fetchMails = async (\n  endpoint: string,\n  accountId: string,\n  headers?: Record<string, string>,\n): Promise<JMAPResponse<Mail[]>> => {\n  const response = await fetch(endpoint, {\n    headers: new Headers({ ...headers, 'Content-Type': 'application/json' }),\n    method: 'POST',\n    body: JSON.stringify({\n      using: ['urn:ietf:params:jmap:core', 'urn:ietf:params:jmap:mail'],\n      methodCalls: [\n        [\n          'Email/query',\n          {\n            accountId,\n            position: 0,\n            limit: 100,\n            calculateTotal: true,\n          },\n          '0',\n        ],\n        [\n          'Email/get',\n          {\n            accountId,\n            '#ids': {\n              resultOf: '0',\n              name: 'Email/query',\n              path: '/ids',\n            },\n            properties: [\n              'threadId',\n              'mailboxIds',\n              'keywords',\n              'hasAttachment',\n              'from',\n              'subject',\n              'receivedAt',\n              'size',\n              'preview',\n            ],\n          },\n          '1',\n        ],\n      ],\n    }),\n  });\n  const json = await response.json();\n  if (!json.methodResponses) {\n    return {\n      success: false,\n      message: 'not a valid JMAP response',\n    };\n  }\n\n  const methodResponses = json.methodResponses;\n  if (\n    !methodResponses ||\n    !Array.isArray(methodResponses) ||\n    methodResponses.length !== 2\n  ) {\n    return {\n      success: false,\n      message: 'no valid response',\n    };\n  }\n\n  const m = methodResponses[1];\n\n  if (m[0] !== 'Email/get') {\n    return {\n      success: false,\n      message: 'not the expected method',\n    };\n  }\n  if (!m[1] || !m[1].list || !Array.isArray(m[1].list)) {\n    return {\n      success: false,\n      message: 'could not fetch emails',\n    };\n  }\n\n  const list = m[1].list as Mail[];\n\n  return {\n    success: true,\n    data: list,\n  };\n};\n\nexport const fetchMail = async (\n  endpoint: string,\n  accountId: string,\n  emailId: string,\n  headers?: Record<string, string>,\n): Promise<JMAPResponse<Mail>> => {\n  const response = await fetch(endpoint, {\n    headers: new Headers({ ...headers, 'Content-Type': 'application/json' }),\n    method: 'POST',\n    body: JSON.stringify({\n      using: ['urn:ietf:params:jmap:core', 'urn:ietf:params:jmap:mail'],\n      methodCalls: [\n        [\n          'Email/get',\n          {\n            accountId,\n            ids: [emailId],\n            properties: [\n              'threadId',\n              'mailboxIds',\n              'keywords',\n              'hasAttachment',\n              'from',\n              'subject',\n              'receivedAt',\n              'size',\n              'preview',\n              'htmlBody',\n            ],\n          },\n          '0',\n        ],\n      ],\n    }),\n  });\n  const json = await response.json();\n  if (!json.methodResponses) {\n    return {\n      success: false,\n      message: 'not a valid JMAP response',\n    };\n  }\n\n  const methodResponses = json.methodResponses;\n  if (\n    !methodResponses ||\n    !Array.isArray(methodResponses) ||\n    methodResponses.length !== 1\n  ) {\n    return {\n      success: false,\n      message: 'no valid response',\n    };\n  }\n\n  const m = methodResponses[0];\n\n  if (m[0] !== 'Email/get') {\n    return {\n      success: false,\n      message: 'not the expected method',\n    };\n  }\n  if (\n    !m[1] ||\n    !m[1].list ||\n    !Array.isArray(m[1].list) ||\n    m[1].list.length !== 1\n  ) {\n    return {\n      success: false,\n      message: 'could not fetch email',\n    };\n  }\n\n  const mail = m[1].list[0] as Mail;\n\n  return {\n    success: true,\n    data: mail,\n  };\n};\n\nexport const tryCredentials = async (\n  endpoint: string,\n  headers?: Record<string, string>,\n): Promise<Record<string, string>> => {\n  const response = await fetch(endpoint, {\n    headers: new Headers({ ...headers, 'Content-Type': 'application/json' }),\n    method: 'GET',\n  });\n  const json = await response.json();\n  return json;\n};\n\nexport const getBasicToken = (username: string, password: string): string => {\n  return Base64.encode(`${username}:${password}`);\n};\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { RootState } from '../../app/store';\n\ninterface LoginState {\n  authenticated: boolean;\n  authorizationHeader: string;\n  identifier: string;\n  downloadUrl: string;\n  endpoint: string;\n}\n\ntype LoginPayload = {\n  authorizationHeader: string;\n  identifier: string;\n  downloadUrl: string;\n  endpoint: string;\n};\n\nconst initialState: LoginState = {\n  authenticated: false,\n  authorizationHeader: '',\n  identifier: '',\n  downloadUrl: '',\n  endpoint: '',\n};\n\nexport const loginSlice = createSlice({\n  name: 'login',\n  initialState,\n  reducers: {\n    login: (state, action: PayloadAction<LoginPayload>) => {\n      state.authenticated = true;\n      state.authorizationHeader = action.payload.authorizationHeader;\n      state.identifier = action.payload.identifier;\n      state.downloadUrl = action.payload.downloadUrl;\n      state.endpoint = action.payload.endpoint;\n    },\n    logout: (state) => {\n      state.authenticated = false;\n      state.authorizationHeader = '';\n      state.identifier = '';\n      state.downloadUrl = '';\n      state.endpoint = '';\n    },\n  },\n});\n\nexport const { login, logout } = loginSlice.actions;\n\nexport const isAuthenticated = (state: RootState): boolean =>\n  state.login.authenticated;\nexport const selectAuthorizationHeader = (state: RootState): string =>\n  state.login.authorizationHeader;\n\nexport const getLoginPayload = (state: RootState): LoginPayload => ({\n  authorizationHeader: state.login.authorizationHeader,\n  identifier: state.login.identifier,\n  downloadUrl: state.login.downloadUrl,\n  endpoint: state.login.endpoint,\n});\n\nexport default loginSlice.reducer;\n","import { useSelector } from 'react-redux';\nimport { useQuery } from 'react-query';\nimport SanitizedHtml from '../../../components/SanitizedHtml';\nimport { fetchMail } from '../../../lib/jmap';\nimport { getLoginPayload } from '../../login/loginSlice';\n\ntype MailProps = {\n  mailId: string;\n};\n\ntype MailContent = {\n  content: string;\n  type: string;\n};\n\ntype FetchMailContentArgs = {\n  endpoint: string;\n  identifier: string;\n  mailId: string;\n  authorizationHeader: string;\n  downloadUrl: string;\n};\n\nconst replaceDownloadUrl = (\n  accountId: string,\n  blobId: string,\n  name: string,\n  type: string,\n  downloadUrl: string,\n  endpoint: string,\n) => {\n  return new URL(\n    downloadUrl\n      .replace(/{accountId}/g, encodeURI(accountId))\n      .replace(/{blobId}/g, encodeURI(blobId))\n      .replace(/{name}/g, encodeURI(name))\n      .replace(/{type}/g, encodeURI(type)),\n    endpoint,\n  ).href;\n};\n\nconst fetchMailContent = async (\n  args: FetchMailContentArgs,\n): Promise<MailContent | undefined> => {\n  const { endpoint, identifier, mailId, authorizationHeader, downloadUrl } =\n    args;\n  const mailRequest = await fetchMail(endpoint, identifier, mailId, {\n    Authorization: authorizationHeader,\n  });\n\n  if (!mailRequest.success) {\n    return;\n  }\n\n  const mailData = mailRequest.data;\n\n  if (!mailData.htmlBody || mailData.htmlBody.length < 1) {\n    return;\n  }\n\n  const body = mailData.htmlBody[0];\n\n  if (!body.blobId) {\n    return;\n  }\n\n  const blobUrl = replaceDownloadUrl(\n    identifier,\n    body.blobId,\n    'content',\n    `${body.type};charset=${body.charset}`,\n    downloadUrl,\n    endpoint,\n  );\n\n  return fetch(blobUrl, {\n    headers: new Headers({\n      'Content-Type': 'application/json',\n      Authorization: authorizationHeader,\n    }),\n  })\n    .then((r) => r.text())\n    .then((t) => ({\n      content: t,\n      type: body.type,\n    }));\n};\n\nfunction Mail(props: MailProps): JSX.Element {\n  const mailId = props.mailId;\n  const loginDetails = useSelector(getLoginPayload);\n  const { authorizationHeader, endpoint, identifier, downloadUrl } =\n    loginDetails;\n\n  const { isLoading, error, data } = useQuery(`mail/${mailId}`, () =>\n    fetchMailContent({\n      endpoint,\n      identifier,\n      mailId,\n      authorizationHeader,\n      downloadUrl,\n    }),\n  );\n\n  if (isLoading) {\n    return <p>Loading…</p>;\n  }\n\n  if (error || !data) {\n    return (\n      <p>\n        An error occured while trying to load the email content… Please try\n        refreshing the page!\n      </p>\n    );\n  }\n\n  return (\n    <div className=\"mail-layout-center has-background-white is-flex-direction-column\">\n      <div className=\"has-text-left\">\n        {(data.type === 'text/plain' && (\n          <pre className=\"p-4 has-background-white\">\n            <SanitizedHtml html={data.content} />\n          </pre>\n        )) || <SanitizedHtml html={data.content} />}\n      </div>\n    </div>\n  );\n}\n\nexport default Mail;\n","function Empty(): JSX.Element {\n  return (\n    <div className=\"mail-layout-center\">\n      <div className=\"has-text-weight-bold\">Nothing selected</div>\n    </div>\n  );\n}\n\nexport default Empty;\n","export const randomString = (length = 8): string => {\n  const chars =\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  const charsLength = chars.length;\n\n  let str = '';\n\n  for (let i = 0; i < length; i++) {\n    str += chars.charAt(Math.floor(Math.random() * charsLength));\n  }\n\n  return str;\n};\n","import { randomString } from '../../lib/random';\n\nexport type Mailbox = {\n  name: string;\n  role: string;\n  id: string;\n  unreadEmails: number;\n};\n\nexport type MailFrom = {\n  name?: string | null;\n  email?: string | null;\n};\n\nexport type Mail = {\n  from: MailFrom[];\n  hasAttachment: boolean;\n  id: string;\n  mailboxIds: Record<string, boolean>;\n  preview: string;\n  subject: string;\n  keywords: Record<string, boolean>;\n  htmlBody?: Record<string, string>[];\n};\n\nexport const newMailbox = (\n  name?: string,\n  role?: string,\n  id?: string,\n  unreadEmails?: number,\n): Mailbox => {\n  return {\n    name: name || '(unknown)',\n    role: role || '',\n    id: id || randomString(36),\n    unreadEmails: unreadEmails || 0,\n  };\n};\n\nexport const newMail = (\n  mailboxId: string,\n  subject?: string,\n  preview?: string,\n  seen = true,\n): Mail => {\n  return {\n    from: [\n      {\n        name: '' || randomString(8),\n        email: '' || `${randomString(4)}@${randomString(4)}.${randomString(2)}`,\n      },\n    ],\n    hasAttachment: false,\n    id: randomString(36),\n    mailboxIds: {\n      [mailboxId]: true,\n    },\n    preview: preview || 'Lorem ipsum…',\n    subject: subject || '(no subject)',\n    keywords: {\n      $seen: seen,\n    },\n  };\n};\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { RootState } from '../../app/store';\nimport { Mailbox, Mail, newMailbox } from './types';\n\ninterface MailState {\n  mailboxes: Mailbox[];\n  list: Mail[];\n}\n\nconst initialState: MailState = {\n  mailboxes: [\n    newMailbox('INBOX', 'inbox', '00000000-0000-0000-0000-000000000001', 1),\n  ],\n  list: [],\n};\n\nexport const mailSlice = createSlice({\n  name: 'mail',\n  initialState,\n  reducers: {\n    setMailboxes: (state, action: PayloadAction<Mailbox[]>) => {\n      state.mailboxes = action.payload;\n    },\n    setList: (state, action: PayloadAction<Mail[]>) => {\n      state.list = action.payload;\n    },\n  },\n});\n\nexport const { setMailboxes, setList } = mailSlice.actions;\n\nexport const selectMailboxes = (state: RootState): Mailbox[] =>\n  state.mail.mailboxes;\n\nexport const selectMails = (state: RootState): Mail[] => state.mail.list;\n\nexport default mailSlice.reducer;\n","import { useRouteMatch } from 'react-router-dom';\nimport { Mail, Mailbox, MailFrom } from './types';\n\ntype RouteMatch = {\n  mailboxId: string;\n  mailId: string;\n};\n\nexport const FEATURE_URL = '/mail/';\n\nexport const getRouteParams = (): RouteMatch => {\n  const matchMailbox = useRouteMatch<RouteMatch>(`${FEATURE_URL}:mailboxId`);\n  const matchMail = useRouteMatch<RouteMatch>(\n    `${FEATURE_URL}:mailboxId/:mailId`,\n  );\n\n  const mailboxId = matchMailbox?.params.mailboxId || '';\n  const mailId = (mailboxId && matchMail?.params.mailId) || '';\n\n  return {\n    mailboxId,\n    mailId,\n  };\n};\n\nexport const getMailboxName = (mailbox: Mailbox): string => {\n  switch (mailbox.role) {\n    case 'inbox':\n      return 'Inbox';\n    case 'drafts':\n      return 'Drafts';\n    case 'sent':\n      return 'Sent Messages';\n    case 'junk':\n      return 'Junk';\n    case 'trash':\n      return 'Deleted Messages';\n    case 'archive':\n      return 'Archive';\n  }\n\n  return mailbox.name;\n};\n\nexport const getMailboxIcon = (mailbox: Mailbox): string => {\n  switch (mailbox.role) {\n    case 'inbox':\n      return 'fas fa-inbox';\n    case 'drafts':\n      return 'fas fa-pencil-alt';\n    case 'sent':\n      return 'fas fa-paper-plane';\n    case 'junk':\n      return 'far fa-times-circle';\n    case 'trash':\n      return 'fas fa-trash-alt';\n    case 'archive':\n      return 'fas fa-archive';\n  }\n\n  if (mailbox.name === 'Notes') {\n    return 'far fa-sticky-note';\n  }\n\n  return 'far fa-folder';\n};\n\nexport const isUnreadMail = (mail: Mail): boolean => {\n  if (mail?.keywords?.$seen === false) {\n    return true;\n  }\n\n  return false;\n};\n\nconst formatName = (from: MailFrom): string => {\n  if (from?.name) {\n    return from.name;\n  } else if (from?.email) {\n    return from.email;\n  }\n\n  return '(unknown)';\n};\n\nexport const getFromMail = (mail: Mail): string => {\n  if (!mail.from || mail.from.length < 1) {\n    return '(unknown)';\n  }\n\n  return mail.from.map((f) => formatName(f)).join(', ');\n};\n","function Empty(): JSX.Element {\n  return (\n    <div className=\"mail-layout-center\">\n      <div className=\"has-text-weight-bold\">\n        Mailbox is empty\n        <nav className=\"navbar has-no-background\"></nav>\n      </div>\n    </div>\n  );\n}\n\nexport default Empty;\n","import { useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { selectMailboxes, selectMails } from '../mailSlice';\nimport { newMailbox } from '../types';\nimport {\n  FEATURE_URL,\n  getFromMail,\n  getMailboxName,\n  getRouteParams,\n  isUnreadMail,\n} from '../utils';\nimport Empty from './Empty';\n\nfunction List(): JSX.Element {\n  const routeParams = getRouteParams();\n  let mailboxId = routeParams.mailboxId;\n\n  const mailboxes = useSelector(selectMailboxes);\n  const mailListAll = useSelector(selectMails);\n\n  if (!mailboxId) {\n    const inboxMailbox = mailboxes.filter(\n      (mailbox) => mailbox.role === 'inbox',\n    );\n    if (inboxMailbox.length > 0) {\n      mailboxId = inboxMailbox[0].id;\n    }\n  }\n\n  const currentMailboxes = mailboxes.filter(\n    (mailbox) => mailbox.id === mailboxId,\n  );\n\n  const currentMailbox =\n    currentMailboxes.length > 0 ? currentMailboxes[0] : newMailbox();\n\n  const mailList = mailListAll.filter((mail) => {\n    if (\n      mail.mailboxIds &&\n      Object.prototype.hasOwnProperty.call(mail.mailboxIds, currentMailbox.id)\n    ) {\n      return mail.mailboxIds[currentMailbox.id];\n    }\n\n    return false;\n  });\n\n  const mailId = routeParams.mailId || '';\n  const backgroundClass = mailList.length > 0 ? 'has-background-white' : '';\n\n  return (\n    <div className=\"is-flex is-flex-grow-1 is-flex-direction-column is-clipped\">\n      <div className=\"mail-layout-title\">\n        <Link\n          to={FEATURE_URL}\n          className=\"button is-small is-white mr-3 only-mobile\"\n        >\n          <span className=\"icon is-small\">\n            <i className=\"fas fa-chevron-left\"></i>\n          </span>\n        </Link>\n        {getMailboxName(currentMailbox)}\n      </div>\n      <div\n        className={`is-flex is-flex-grow-1 is-flex-direction-column overflowable ${backgroundClass}`}\n      >\n        {mailList.length === 0 ? (\n          <Empty />\n        ) : (\n          mailList.map((mail) => {\n            const className =\n              isUnreadMail(mail) || mail.id === mailId\n                ? 'app-item-selected'\n                : 'app-item';\n            return (\n              <Link to={`${FEATURE_URL}${mailboxId}/${mail.id}`} key={mail.id}>\n                <div className={className}>\n                  <p>{getFromMail(mail)}</p>\n                  <p>{mail.subject}</p>\n                  <p>{mail.preview}</p>\n                </div>\n              </Link>\n            );\n          })\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default List;\n","function Empty(): JSX.Element {\n  return (\n    <div className=\"mail-layout-center\">\n      <div className=\"has-text-weight-bold\">You do not have any mailboxes</div>\n    </div>\n  );\n}\n\nexport default Empty;\n","import { useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { selectMailboxes } from '../mailSlice';\nimport { getMailboxIcon, getMailboxName, getRouteParams } from '../utils';\nimport Empty from './Empty';\n\nfunction List(): JSX.Element {\n  const mailboxes = useSelector(selectMailboxes);\n\n  const routeParams = getRouteParams();\n  let mailboxId = routeParams.mailboxId || 'inbox';\n  if (mailboxId === 'inbox') {\n    mailboxId = mailboxes.length > 0 ? mailboxes[0].id : '';\n  }\n\n  return mailboxes.length === 0 ? (\n    <Empty />\n  ) : (\n    <div className=\"is-flex-grow-1 overflowable\">\n      {mailboxes.map((mailbox) => {\n        const className =\n          mailbox.id === mailboxId ? 'app-item-selected' : 'app-item';\n        return (\n          <Link to={`/mail/${mailbox.id}`} key={mailbox.id}>\n            <div className={`icon-text ${className}`}>\n              <span className=\"icon mr-3\">\n                <i className={getMailboxIcon(mailbox)}></i>\n              </span>\n              <span>{getMailboxName(mailbox)}</span>\n              {mailbox.unreadEmails > 0 && (\n                <span className=\"tag is-normal is-rounded is-primary has-text-weight-bold ml-3\">\n                  {mailbox.unreadEmails}\n                </span>\n              )}\n            </div>\n          </Link>\n        );\n      })}\n    </div>\n  );\n}\n\nexport default List;\n","import './Layout.css';\nimport MailContent from './content/Mail';\nimport MailEmpty from './content/Empty';\nimport MailList from './list/List';\nimport Mailboxes from './mailboxes/List';\nimport { getRouteParams } from './utils';\n\nfunction Layout(): JSX.Element {\n  const routeParams = getRouteParams();\n\n  let mailboxesClass = '';\n  let listClass = 'hide-mobile';\n  let contentClass = 'hide-mobile';\n\n  if (routeParams.mailboxId) {\n    if (routeParams.mailId) {\n      mailboxesClass = 'hide-mobile';\n      listClass = 'hide-mobile';\n      contentClass = '';\n    } else {\n      mailboxesClass = 'hide-mobile';\n      listClass = '';\n      contentClass = 'hide-mobile';\n    }\n  }\n\n  return (\n    <div className=\"mail-layout\">\n      <div className={`mail-layout-mailboxes ${mailboxesClass}`}>\n        <Mailboxes />\n      </div>\n      <div className={`mail-layout-focused mail-layout-list ${listClass}`}>\n        <MailList />\n      </div>\n      <div className={`mail-layout-content ${contentClass}`}>\n        {routeParams.mailboxId && routeParams.mailId ? (\n          <MailContent mailId={routeParams.mailId} />\n        ) : (\n          <MailEmpty />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Layout;\n","import { useState } from 'react';\nimport { batch, useDispatch } from 'react-redux';\nimport ConditionalDisplay from '../../components/ConditionalDisplay';\nimport {\n  discoverJmapEndpoint,\n  fetchMailboxes,\n  fetchMails,\n  getBasicToken,\n  tryCredentials,\n} from '../../lib/jmap';\nimport { setList, setMailboxes } from '../mail/mailSlice';\nimport './Layout.css';\nimport { login } from './loginSlice';\n\nenum LoginStep {\n  Identifier = 0,\n  Endpoint,\n  Credentials,\n}\n\nfunction Layout(): JSX.Element {\n  const dispatch = useDispatch();\n\n  const [step, setStep] = useState<LoginStep>(LoginStep.Identifier);\n  const [error, setError] = useState<string>('');\n  const [more, setMore] = useState<boolean>(false);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [identifier, setIdentifier] = useState<string>('');\n  const [password, setPassword] = useState<string>('');\n  const [endpoint, setEndpoint] = useState<string>('');\n  const [hasCustomEndpoint, setHasCustomEndpoint] = useState<boolean>(false);\n  const method = 'Basic';\n\n  const discoverEndpoint = async () => {\n    if (loading) return;\n    setLoading(true);\n\n    if (!identifier.includes('@')) {\n      setError(\n        'Your identifier is not an email. Please specify an endpoint manually.',\n      );\n      setStep(LoginStep.Endpoint);\n      setLoading(false);\n      return;\n    }\n\n    const domain = identifier.trim().split('@').pop();\n    if (!domain) {\n      setError(\n        'Unable to discover a domain name in your email identifier. Please specify an endpoint manually.',\n      );\n      setStep(LoginStep.Endpoint);\n      setLoading(false);\n      return;\n    }\n\n    const discoveredEndpoint = await discoverJmapEndpoint(domain);\n\n    setEndpoint(discoveredEndpoint);\n    setStep(LoginStep.Credentials);\n\n    setLoading(false);\n  };\n\n  const actionButton = async () => {\n    if (loading) return;\n    setLoading(true);\n\n    if (step === LoginStep.Identifier) {\n      setLoading(false);\n      await discoverEndpoint();\n      setLoading(true);\n    }\n\n    if (step === LoginStep.Endpoint) {\n      if (endpoint === '') {\n        setError('Endpoint is empty.');\n        setLoading(false);\n        return;\n      }\n      setHasCustomEndpoint(true);\n      setStep(LoginStep.Credentials);\n    }\n\n    if (step === LoginStep.Credentials) {\n      let userInfos;\n      const authorizationHeader = `Basic ${getBasicToken(\n        identifier,\n        password,\n      )}`;\n      try {\n        userInfos = await tryCredentials(endpoint, {\n          Authorization: authorizationHeader,\n        });\n      } catch (e) {\n        setError('Bad credentials. Please retry.');\n        setLoading(false);\n        return;\n      }\n\n      let downloadUrl = '';\n      if (userInfos.downloadUrl) {\n        downloadUrl = userInfos.downloadUrl;\n      }\n\n      const mailboxesRequest = await fetchMailboxes(endpoint, identifier, {\n        Authorization: authorizationHeader,\n      });\n\n      if (!mailboxesRequest.success) {\n        setError(mailboxesRequest.message);\n        setLoading(false);\n        return;\n      }\n\n      const mailsRequest = await fetchMails(endpoint, identifier, {\n        Authorization: authorizationHeader,\n      });\n      if (!mailsRequest.success) {\n        setError(mailsRequest.message);\n        setLoading(false);\n        return;\n      }\n\n      batch(() => {\n        dispatch(\n          login({ identifier, authorizationHeader, downloadUrl, endpoint }),\n        );\n        dispatch(setMailboxes(mailboxesRequest.data));\n        dispatch(setList(mailsRequest.data));\n      });\n\n      return;\n    }\n\n    setLoading(false);\n  };\n\n  return (\n    <div className=\"login-layout\">\n      <div>\n        {error && (\n          <article className=\"message is-danger\">\n            <div className=\"message-body\">{error}</div>\n          </article>\n        )}\n\n        <div className=\"field\">\n          <label className=\"label\" htmlFor=\"login-form-identifier\">\n            Identifier\n          </label>\n          <div className=\"control\">\n            <input\n              autoFocus\n              id=\"login-form-identifier\"\n              className=\"input\"\n              type=\"email\"\n              placeholder=\"john.doe@example.com\"\n              value={identifier}\n              onChange={(e) => setIdentifier(e.target.value)}\n            />\n          </div>\n        </div>\n\n        <ConditionalDisplay\n          cond={more || step === LoginStep.Endpoint || hasCustomEndpoint}\n        >\n          <div className=\"field\">\n            <label className=\"label\" htmlFor=\"login-form-endpoint\">\n              Endpoint\n            </label>\n            <div className=\"control\">\n              <input\n                id=\"login-form-endpoint\"\n                className=\"input\"\n                type=\"url\"\n                placeholder=\"https://example.com\"\n                value={endpoint}\n                onChange={(e) => setEndpoint(e.target.value)}\n              />\n            </div>\n            <p className=\"help\">\n              <span\n                className=\"has-text-primary has-pointer\"\n                onClick={discoverEndpoint}\n              >\n                Discover endpoint\n              </span>\n            </p>\n          </div>\n        </ConditionalDisplay>\n\n        <ConditionalDisplay cond={more}>\n          <div className=\"field\">\n            <label className=\"label\" htmlFor=\"login-form-method\">\n              Authentication method\n            </label>\n            <div className=\"control\">\n              <div className=\"select is-fullwidth\">\n                <select id=\"login-form-method\" disabled>\n                  <option value={method}>Password</option>\n                </select>\n              </div>\n            </div>\n            <p className=\"help\">\n              <span className=\"has-text-primary has-pointer\">\n                Discover the available authentication methods\n              </span>\n            </p>\n          </div>\n        </ConditionalDisplay>\n\n        <ConditionalDisplay cond={more || step >= LoginStep.Credentials}>\n          <div className=\"field\">\n            <label className=\"label\" htmlFor=\"login-form-password\">\n              Password\n            </label>\n            <div className=\"control\">\n              <input\n                id=\"login-form-password\"\n                className=\"input\"\n                type=\"password\"\n                placeholder=\"********\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n              />\n            </div>\n          </div>\n        </ConditionalDisplay>\n\n        <div className=\"login-layout-bottom\">\n          <button\n            className=\"button is-primary\"\n            onClick={() => actionButton()}\n            disabled={identifier === '' && !more}\n          >\n            {((more || step === LoginStep.Credentials) && 'Sign In') ||\n              'Next »'}\n          </button>\n          <label className=\"checkbox\">\n            <input\n              type=\"checkbox\"\n              checked={more}\n              onChange={(e) => setMore(e.target.checked)}\n            />\n            <span>More options</span>\n          </label>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Layout;\n","import React from 'react';\n\nexport type ConditionalDisplayProps = {\n  cond: boolean;\n  children: React.ReactNode;\n};\n\nconst ConditionalDisplay: React.FC<ConditionalDisplayProps> = (props) => {\n  return <>{props.cond && props.children}</>;\n};\n\nexport default ConditionalDisplay;\n","export const FEATURE_URL = '/login/';\n","import { Switch } from 'react-router';\nimport { Redirect, Route } from 'react-router-dom';\nimport '@fortawesome/fontawesome-free/js/all';\nimport MailLayout from './features/mail/Layout';\nimport LoginLayout from './features/login/Layout';\nimport { FEATURE_URL as MailUrl } from './features/mail/utils';\nimport { FEATURE_URL as LoginUrl } from './features/login/utils';\nimport './App.css';\nimport { useSelector } from 'react-redux';\nimport { isAuthenticated } from './features/login/loginSlice';\n\nfunction App(): JSX.Element {\n  const authenticated = useSelector(isAuthenticated);\n\n  return (\n    <div className=\"app\">\n      <nav className=\"navbar is-primary\">\n        <div className=\"navbar-brand\">\n          <div className=\"navbar-item\">JMAP Webmail</div>\n        </div>\n      </nav>\n      <div className=\"app-container\">\n        <Switch>\n          <Route\n            path={MailUrl}\n            render={() => {\n              return authenticated ? (\n                <MailLayout />\n              ) : (\n                <Redirect to={LoginUrl} />\n              );\n            }}\n          />\n          <Route\n            path={LoginUrl}\n            render={() => {\n              return !authenticated ? (\n                <LoginLayout />\n              ) : (\n                <Redirect to={MailUrl} />\n              );\n            }}\n          />\n          <Route\n            path=\"/\"\n            exact={false}\n            render={() => {\n              return authenticated ? (\n                <Redirect to={MailUrl} />\n              ) : (\n                <Redirect to={LoginUrl} />\n              );\n            }}\n          />\n        </Switch>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { AppThunk, RootState } from '../../app/store';\n\ninterface CounterState {\n  value: number;\n}\n\nconst initialState: CounterState = {\n  value: 0,\n};\n\nexport const counterSlice = createSlice({\n  name: 'counter',\n  initialState,\n  reducers: {\n    increment: (state) => {\n      // Redux Toolkit allows us to write \"mutating\" logic in reducers. It\n      // doesn't actually mutate the state because it uses the Immer library,\n      // which detects changes to a \"draft state\" and produces a brand new\n      // immutable state based off those changes\n      state.value += 1;\n    },\n    decrement: (state) => {\n      state.value -= 1;\n    },\n    // Use the PayloadAction type to declare the contents of `action.payload`\n    incrementByAmount: (state, action: PayloadAction<number>) => {\n      state.value += action.payload;\n    },\n  },\n});\n\nexport const { increment, decrement, incrementByAmount } = counterSlice.actions;\n\n// The function below is called a thunk and allows us to perform async logic. It\n// can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This\n// will call the thunk with the `dispatch` function as the first argument. Async\n// code can then be executed and other actions can be dispatched\nexport const incrementAsync =\n  (amount: number): AppThunk =>\n  (dispatch) => {\n    setTimeout(() => {\n      dispatch(incrementByAmount(amount));\n    }, 1000);\n  };\n\n// The function below is called a selector and allows us to select a value from\n// the state. Selectors can also be defined inline where they're used instead of\n// in the slice file. For example: `useSelector((state: RootState) => state.counter.value)`\nexport const selectCount = (state: RootState): number => state.counter.value;\n\nexport default counterSlice.reducer;\n","import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit';\nimport counterReducer from '../features/counter/counterSlice';\nimport mailReducer from '../features/mail/mailSlice';\nimport loginReducer from '../features/login/loginSlice';\n\nexport const store = configureStore({\n  reducer: {\n    counter: counterReducer,\n    mail: mailReducer,\n    login: loginReducer,\n  },\n});\n\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n","/* eslint-disable no-console */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config): void {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      );\n    });\n}\n\nexport function unregister(): void {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bulma/css/bulma.min.css';\nimport './index.css';\nimport App from './App';\nimport { store } from './app/store';\nimport { Provider } from 'react-redux';\nimport * as serviceWorker from './serviceWorker';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport { QueryClient, QueryClientProvider } from 'react-query';\n\nconst queryClient = new QueryClient();\n\nReactDOM.render(\n  <React.StrictMode>\n    <QueryClientProvider client={queryClient}>\n      <Provider store={store}>\n        <Router>\n          <App />\n        </Router>\n      </Provider>\n    </QueryClientProvider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}